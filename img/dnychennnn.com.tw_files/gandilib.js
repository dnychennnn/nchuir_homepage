function declareNamespaces(path){var parts=path.split(".");var parentNamespace;$.each(parts,function(i,ns){if(i==0){parentNamespace=eval(ns);return true}parentNamespace[ns]=parentNamespace[ns]||{};parentNamespace=parentNamespace[ns]})}var GANDI={News:{load:function(){var a=$("<a>").attr("id","news-modal").attr("href","/admin/ajax/news?start=1").hide();$("body").append(a);a.ajaxModal();a.trigger("click")}},Cookie:{read:function(a){return(document.cookie.match("(^|; )"+a+"=([^;]*)")||0)[2]}},Storage:Class.$extend({__init__:function(a){this._values={};this._namespace=a},set:function(a,b){if(localStorage){this._values=JSON.parse(localStorage.getItem(this._namespace))||{};this._values[a]=b;localStorage.setItem(this._namespace,JSON.stringify(this._values))}else{this._values[a]=b}},get:function(a){if(localStorage){this._values=JSON.parse(localStorage.getItem(this._namespace))||{}}return this._values[a]}}),Ajax:{init:function(a,c,b){var d=Class.$extend({__init__:function(e,f){var g=this,f=f||{};this._deferred=new jQuery.Deferred();this._xhr=undefined;this._event=e;this._$element=this._event?$(this._event.currentTarget):$();this._url=f.url||function(){if(g._$element.is("form")){return g._$element.attr("action")}if(g._$element.is("a")){return g._$element.attr("href")}}();this._options=b;this._xhrArgs={};this._options=$.extend(true,{defaultCallbacks:true,confirmationMessage:"",scrollToMessage:true,preventDefault:true,csrf:false},b);this._config=$.extend(true,{url:this._url,type:"post",data:g._getData(),dataType:"json",beforeSend:function(){$("body").addClass("progress")},success:function(){g._xhrArgs.success=arguments;if(g._options.defaultCallbacks){g._defaultSuccess.apply(g,arguments)}},error:function(){g._xhrArgs.error=arguments;if(g._options.defaultCallbacks){g._defaultError.apply(g,arguments)}},complete:function(){$("body").removeClass("progress");if(g._options.defaultCallbacks){g._defaultWarning.apply(g,arguments)}}},c);if(this._options.preventDefault){this._preventDefault()}this._resolvedPreAjaxDeferred()},get$Element:function(){return this._$element},on:function(f){var e=this;this.waitPreAjaxCalls().then(function(g){$.each(f,function(h,j){g[h](function(){var k=e._xhrArgs[h]||[];j.apply(e,k)})})});return e},_preventDefault:function(){if(this._event){this._event.preventDefault()}},_resolvedPreAjaxDeferred:function(){var e=true,f=this;if(this._options.confirmationMessage){e=window.confirm(this._options.confirmationMessage)}if(e){if(this._options.csrf){$.getJSON("/ajax/csrf",function(g){f._config.data._csrf_=g.csrf;f._xhr=$.ajax(f._config);f._deferred.resolve(f._xhr)})}else{f._xhr=$.ajax(f._config);f._deferred.resolve(f._xhr)}}else{f._deferred.reject()}},waitPreAjaxCalls:function(){return this._deferred.promise()},getXHR:function(){return this._xhr},_getData:function(){var e=this;var f={};f._csrf_=$("[name=_csrf_]").eq(0).val();if(this._$element.is("form")){f=$.extend(true,f,e._$element.serializeObject({useCustomSerializeArray:true}))}return f},_defaultSuccess:function(f){var e=this._isResponseJSON()?(f.message||""):f;GANDI.Message.info(e,{scrollTo:false})},_defaultWarning:function(g,j,h){var e=[];if(this._isResponseJSON()){var f=jQuery.parseJSON(g.responseText)["warning"];if(f){e.push(jQuery.parseJSON(g.responseText)["warning"])}}else{e.push(g.textResponse)}if(e.length){GANDI.Message.warning(e,{scrollTo:false})}},_defaultError:function(h,l,j){var k=[];if(this._isResponseJSON()){try{var f=jQuery.parseJSON(h.responseText)["error"];if(f){k.push(f)}var e=jQuery.parseJSON(h.responseText)["raw_error"];if(e){k.push(r("(%s)",e))}}catch(g){}}else{k.push(h.textResponse)}if(k.length){GANDI.Message.error(k,{scrollTo:false})}},_isResponseJSON:function(){return this._config.dataType=="json"}});return d(a,c,b)}},Message:Class.$extend({__classvars__:{_displayedMessages:{},_autoHideTimer:2,_autoHideMessageDuration:g_dev?30:15,_timerStarted:false,info:function(b,a){this._display(b,$.extend({style:"box-messages",title:Translations._("js_info"),type:"info"},a))},warning:function(b,a){this._display(b,$.extend({style:"box-warnings",title:Translations._("js_warning"),type:"warning"},a))},error:function(a,b){this._display(a,$.extend({style:"box-errors",title:Translations._("js_error"),type:"error",sticky:true},b))},has:function(b){var a=r(".box-%s ul",b);return $(a).length>0},hideAll:function(c){var b=$.extend({delay:200},c);var a=this;$.each(this._displayedMessages,function(e,d){a._hide(e,b.delay)});return this},_display:function(g,k){var m=this;var a=Tools.Math.uuid(5);var f=$.extend({uuid:a,type:"info",replace:false,sticky:false,title:"",containerId:"ajax-messages",classBox:"box",style:"box-messages",id:a,scrollTo:150,jGrowl:0,jGrowlConfig:{life:(m._autoHideMessageDuration*1000),position:"center"}},k);m._startAutoHideTimer();if(!g){return}if(!$.isArray(g)){g=[g]}g=$.grep(g,function(n){return n});if(!g.length){return}if(g.length&&(f.jGrowl||g_global_environment=="bo")){if(!$.jGrowl){console.error("jGrowl is not loaded!")}else{$.jGrowl(g,$.extend(f.jGrowlConfig,{header:f.title,theme:f.style.replace("box-","")}))}return}var l=$("#"+f.containerId);if(!l.length){var l=$("<div/>").attr("id",f.containerId);$("#main").prepend(l)}var h=[];$.each(this._displayedMessages,function(n,o){if(o.escapedText==m._escapeText(g)){h.push(o)}});if(!f.replace&&h.length){var b=h[0]["$e"];if(b.is(":visible")){var e=b.css("background-color");b.animate({backgroundColor:"#FFFFD4",},150).animate({backgroundColor:e,},150)}if(b.is(":visible")&&f.scrollTo){$("body").scrollTo($("#main"),f.scrollTo)}return}var d=["gandi-message",f.classBox,f.style,f.sticky?"sticky":"",];var b=f.replace?this._getLastestBox():$();if(!b.length){b=$("<div>").addClass(d.join(" ")).attr("id",f.id)}if(f.replace){b.html("")}if(f.title){var j=$("<strong>").html(f.title);b.append(j)}b.append(this._create$List(g));l.append(b);var c=new Date();this._displayedMessages[a]={"$e":b,time:c.getTime()/1000,escapedText:this._escapeText(g),type:f.type};if(b.is(":visible")&&f.scrollTo){$("body").scrollTo($("#main"),f.scrollTo)}},_getLastestBox:function(){var a=$();$.each(this._displayedMessages,function(b,c){a=c["$e"];return false});return a},_create$List:function(b){var a=$("<ul>");$.each(b,function(c,d){var e=$("<li>").html(d);a.append(e)});return a},_hide:function(c,b){var a=this,b=b||200;if(this._displayedMessages[c]){this._displayedMessages[c]["$e"].fadeOut(b,function(){$(this).remove();delete a._displayedMessages[c]})}},_startAutoHideTimer:function(){if(this._timerStarted){return}var a=this;this._timerStarted=1;window.setInterval(function(){var b=new Date();$.each(a._displayedMessages,function(d,c){if(c["$e"].hasClass("sticky")){return true}if((b.getTime()/1000)>(c.time+a._autoHideMessageDuration)){a._hide(d)}})},(a._autoHideTimer*1000))},_escapeText:function(a){return a.join("").toLowerCase().replace(/\s+/,"")}}})};var AJAX=Class.$extend({__classvars__:{AUTOHIDE_TIME:g_dev?15000:5000,_options:{},_timeStartFlashMssg:null,ajaxify:function(el,settings){var that=this;var jqXHR;that._options={attr:"",url:"",confirmationMessage:"",params:{},type:"",dataType:"",async:true,beforeSend:false,success:false,error:false,complete:false};that._options=$.extend(that._options,settings);var isForm=false;var $form;if(!that._options.attr||!that._options.type){switch($(el).tagName()){case"form":that._options.attr=that._options.attr||"action";that._options.type=that._options.type||"POST";isForm=true;$form=$(el);break;case"a":default:that._options.attr=that._options.attr||"href";that._options.type=that._options.type||"GET";$form=$(el).parents("form");break}}that._options.url=that._options.url||$(el).attr(that._options.attr);if(!that._options.url){if(isForm){that._options.url=window.location}else{console.error("No url found for element ",el);return false}}var $csrf=$form&&$form.find('input[name="_csrf_"]').eq(0);if($csrf&&$csrf.length){that._options.params[$csrf.attr("name")]=$csrf.val()}var action=function(){$("body").addClass("progress");return $.ajax({type:that._options.type,data:that._options.params,dataType:that._options.dataType,url:that._options.url,async:that._options.async,beforeSend:function(XMLHttpRequest){if(that._options.beforeSend){that._options.beforeSend(XMLHttpRequest)}if(isForm&&that._options.params.beforeSend){eval(that._options.params.beforeSend)(XMLHttpRequest,$(el))}},success:function(response){$("body").removeClass("progress");if(that._options.success){that._options.success(response,$(el))}if(isForm&&that._options.params.success){eval(that._options.params.success)(response,$(el))}},error:function(XMLHttpRequest,textStatus,errorThrown){$("body").removeClass("progress");if(g_dev){console.error(textStatus,XMLHttpRequest.status,errorThrown)}if($.inArray(XMLHttpRequest.status,[0,401,404])==-1){if(that._options.error){that._options.error(XMLHttpRequest,textStatus,errorThrown,$(el))}else{if(isForm&&that._options.params.error){eval(that._options.params.error)(XMLHttpRequest,textStatus,errorThrown,$(el))}else{GANDI.Message.error(XMLHttpRequest.responseText)}}}},complete:function(XMLHttpRequest,textStatus){if(that._options.complete){that._options.complete(XMLHttpRequest,textStatus,$(el))}if(isForm&&that._options.params.complete){eval(that._options.params.complete)(XMLHttpRequest,textStatus,$(el))}}})};that._options.confirmationMessage=that._options.confirmationMessage||that._options.params.confirmationMessage;if(!that._options.confirmationMessage||Prompt.confirm(that._options.confirmationMessage)){jqXHR=action()}$("tr").removeClass("open-action");return jqXHR},translate:function(a,d){var b=d||{};var c=this._options.translations[g_lang][a];$.each(b,function(f,e){if(e){c=c.replace(new RegExp(f),e)}});return c},hashifyForm:function(a){return a.serializeObject()},showMessage:function(h,a){var c={container_id:"ajax-messages",class_box:"box-fbox",klass:"message",id_box:"",scroll_to:true,redirect_uri:"",sticky:false};c=$.extend(c,a);if(!h){return 1}var g=$("#"+c.container_id);var d=[c.class_box];if(c.sticky){d.push("sticky")}var f=$('<div class="'+d.join(" ")+'" id="'+c.id_box+'"></div>').addClass(c.klass).html(h);if(!g.length){var g=$('<div id="'+c.container_id+'"></div>');$("#main").prepend(g)}if(c.id_box&&$("#"+c.id_box).length){$("#"+c.id_box).replaceWith(f);$("#"+c.id_box).hide().fadeIn()}else{var e=this._checkIfMessagePresent(h,g);if(e){e.replaceWith(f.hide().fadeIn())}else{g.append(f.hide().fadeIn())}}if(c.scroll_to){$("body").scrollTo(f,150)}var b=new Date();this._timeStartFlashMssg=b.getTime()},showWarning:function(c,a){var b={klass:"warning"};b=$.extend(b,a);this.showMessage(c,b)},showError:function(c,a){var b={klass:"error"};b=$.extend(b,a);this.showMessage(c,b)},hasError:function(){var a={container_selector:"#ajax-messages div,.jGrowl-notification.errors:visible"};return $(a.container_selector).length>0},hideMessages:function(){var a={container_selector:"#ajax-messages",message_selector:"div:not(.sticky):not(.gandi-message)"};var b=$(a.container_selector);if(b.length){b.find(a.message_selector).each(function(){$(this).fadeOut(function(){$(this).remove()})})}},autoHideMessages:function(){var a=this;window.setInterval(function(){var b=new Date();if(b.getTime()>a._timeStartFlashMssg+a.AUTOHIDE_TIME){AJAX.hideMessages()}},a.AUTOHIDE_TIME)},showSpinner:function(){$("body").addClass("progress")},hideSpinner:function(){$("body").removeClass("progress")},_checkIfMessagePresent:function(e,d){var c=false;var a=$("<div>"+e+"</div>").text();var b=new RegExp("^"+a+"$");d.children().each(function(){if($(this).text().match(b)){c=$(this);return false}});return c}}});var Prompt=Class.$extend({__classvars__:{_disabled:0,setDisabled:function(a){return Prompt().$class._disabled=a},isDisabled:function(){return Prompt().$class._disabled},confirm:function(a){return !Prompt().$class.isDisabled()?window.confirm(a):true},alert:function(a){return !Prompt().$class.isDisabled()?window.alert(a):true},beforeUnload:function(a){if(!Prompt().$class.isDisabled()){window.onbeforeunload=function(b){return a()}}}}});var Querystring=Class.$extend({__init__:function(a){this._qs=a;this._params={};if(this._qs==null){this._qs=location.search.substring(1,location.search.length)}if(this._qs.length==0){return}this._qs=this._qs.replace(/\+/g," ");this._qs=this._qs.replace(/^\?/g,"");var b=this._qs.split("&");for(var d=0;d<b.length;d++){var e=b[d].indexOf("=");var g=[b[d].slice(0,e),b[d].slice(e+1)];var c=decodeURIComponent(g[0]);var f=(g.length==2)?decodeURIComponent(g[1]):c;if(c.match(/\[\]/)){this._params[c]?this._params[c].push(f):this._params[c]=[f]}else{this._params[c]=f}}},get:function(a,b){var c=this._params[a];return(c!=null)?c:b},getParams:function(){return this._params},contains:function(a){var b=this._params[a];return(b!=null)},has:function(c){var b=false;var d=new RegExp(c);for(var a in this._params){if(d.test(a)){b=true;break}}return b},add:function(a,b){this._params[a]=b},toStr:function(){return Querystring().$class.from(this._params)},__classvars__:{from:function(b){var c=new Array();for(var a in b){c.push(a+"="+b[a])}return"?"+c.join("&")}}});var Tools={Array:Class.$extend({__classvars__:{countValues:function(f,e){var a={},d=f.length,c;while(d--){c=a[f[d]];a[f[d]]=c?c+1:1}return a[e]},indexOf:function(c,b){if(Array.indexOf){return c.indexOf(b)}for(var a=0;a<c.length;a++){if(c[a]==b){return a}}return -1},join:function(c,b){var a=$.map(c,function(e,d){return e?e:null});return a.join(b)},unique:function(a){return $.grep(a,function(c,b){return b==$.inArray(c,a)})}}}),Object:Class.$extend({__classvars__:{size:function(b){var c=0;for(var a in b){if(b.hasOwnProperty(a)){c++}}return c},keys:function(b){var a=[];for(i in b){if(b.hasOwnProperty(i)){a.push(i)}}return a}}}),String:Class.$extend({__classvars__:{underscoresToCamelCase:function(b){var c=b.split("_");var a=[];$.each(c,function(d,e){if(d==0){a.push(e)}else{e=e.charAt(0).toUpperCase()+e.slice(1);a.push(e)}});return a.join("")},random:function(){var d="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz";var e=8;var c="";for(var b=0;b<e;b++){var a=Math.floor(Math.random()*d.length);c+=d.substring(a,a+1)}return c},replace:function(){var a=arguments[0];var b=$.isArray(arguments[1])?arguments[1]:[].slice.call(arguments,1);$.each(b,function(d,c){a=a.replace(/\$[0-9a-zA-Z]+|%[a-z]{1}/,(c===undefined?"":c))});return a},utf8Encode:function(a){return unescape(encodeURIComponent(a))},utf8Decode:function(a){return decodeURIComponent(escape(a))},htmlEncode:function(a){return $("<div/>").text(a).html()},htmlDecode:function(a){return $("<div/>").html(a).text()},checkEmail:function(a){var b=new RegExp(/^(([a-z0-9_\.\+\-\=\?\^\#]){1,64}\@(([a-z0-9\-]){1,251}\.){1,252}[-a-z0-9]{2,63})$/i);return b.test(a)},checkSMSNumber:function(a){return/^\+\d{2}\.[0-9]{6,}$/.test(a)},capitalize:function(a){return a.substr(0,1).toUpperCase()+a.slice(1)},truncate:function(b,a,c){c=c||"&hellip;";if(b.length>=a){b=b.substr(0,a)+c}return b}}}),Date:Class.$extend({__classvars__:{toStringWithLeadingZeroes:function(a){return("0"+a.getDate()).slice(-2)+"/"+("0"+(a.getMonth()+1)).slice(-2)+"/"+a.getFullYear()+" "+("0"+a.getHours()).slice(-2)+":"+("0"+a.getMinutes()).slice(-2)},toString:function(a){return[a.getFullYear(),("0"+(a.getMonth()+1)).slice(-2),("0"+a.getDate()).slice(-2)].join("-")+" "+[("0"+a.getHours()).slice(-2),("0"+a.getMinutes()).slice(-2),("0"+a.getSeconds()).slice(-2)].join(":")}}}),Math:Class.$extend({__classvars__:{CHARS:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),uuid:function(a,d){var f=Tools.Math().$class.CHARS,c=[];d=d||f.length;if(a){for(var b=0;b<a;b++){c[b]=f[0|Math.random()*d]}}else{var e;c[8]=c[13]=c[18]=c[23]="-";c[14]="4";for(var b=0;b<36;b++){if(!c[b]){e=0|Math.random()*16;c[b]=f[(b==19)?(e&3)|8:e]}}}return c.join("")}}}),Range:Class.$extend({__classvars__:{selectText:function(a){if(document.selection){var b=document.body.createTextRange();b.moveToElementText(document.getElementById(a));b.select()}else{if(window.getSelection()){var b=document.createRange();b.selectNode(document.getElementById(a));window.getSelection().removeAllRanges();window.getSelection().addRange(b)}}},unselectText:function(){if(document.selection){document.selection.empty()}else{if(window.getSelection){window.getSelection().removeAllRanges()}}}}}),Format:Class.$extend({__classvars__:{currency:function(b,c){c=$.extend({digits:2,tax:null,space:"&nbsp;"},c);var a;switch(g_currency){case"EUR":a=b.toFixed(c.digits)+c.space+"€";a=a.replace(/\./g,",");break;case"USD":a="$"+b.toFixed(c.digits);break;case"GBP":a="£"+b.toFixed(c.digits);break;case"TWD":a="NT$"+b.toFixed(0);break;case"CNY":a=b.toFixed(0)+c.space+"元";break;default:a=b.toFixed(c.digits)+c.space+g_currency;a=a.replace(/\./g,",");break}if(c.tax!==null){var a=c.tax?Translations._("ttc_amount",a):Translations._("ht_amount",a)}return a},thousandSep:function(f){var c=3;var b=parseInt(f)+"";var d=f-b+"";d=d.substr(1,c);var e="";var a="";switch(g_lang){case"en":e=",";break;default:e=" ";break}if(b.length/c<=1){a=b}else{do{thousandIndex=b.length-c;thousandDiv=b.substr(thousandIndex,c);b=b.substr(0,thousandIndex);a=e+thousandDiv+a}while(b.length>c);if(b.length>0){a=b+a}}return a+d},formatNumber:function(c){var b="";var a=c.toString();switch(g_lang){case"en":b=".";break;default:b=",";break}return a.replace(/\.0+/,"").replace(/\./,b)},size:function(b,d,c){c=$.extend({units:{fr:["o","Ko","Mo","Go","To"],en:["B","KB","MB","GB","TB"],es:["B","KB","MB","GB","TB"]}},c);if(!d){var a=2;while(b>=1024){b/=1024;a++}d=Math.pow(1024,a)}switch(d){case Math.pow(1024,0):return b+" "+c.units[g_lang][0];break;case Math.pow(1024,1):return b+" "+c.units[g_lang][1];break;case Math.pow(1024,2):return b+" "+c.units[g_lang][2];break;case Math.pow(1024,3):return b+" "+c.units[g_lang][3];break;case Math.pow(1024,4):return b+" "+c.units[g_lang][4];break;default:return b+" "+c.units[g_lang][2];break}return Math.round(b*1000)/1000},handle:function(a){var b=$.trim(a);if(/^(?!\w+-gandi$)\w+/i.test(b)){b=(/^\w+/.exec(b)+"-gandi")}return b.toUpperCase()}}})};var r=Tools.String.replace;var AbstractPageManager=Class.$extend({_config:{container:"div#globalbox",selector:{},parameters:{},translations:{},urls:{}},__init__:function(a){this._uuid=Tools.Math.uuid(5);this._config=$.extend(true,{},this._config,a);this._parameters=this._config.parameters;this._init();this._initBindings();this._startUp()},setParams:function(a){this._parameters=$.extend(this._config.parameters,a);return this},getParam:function(a){return this._parameters[a]},setSelector:function(a,b){this._config.selector[a]=b;return this},setConfig:function(a){this._config=$.extend(true,{},this._config,a);return this},getSelector:function(a,b){b=b||[];return r(this._config.selector[a],b)},get$Container:function(){return this._config.container?$(this._config.container):$()},get$:function(){var b=arguments[0];var c=[].slice.call(arguments,1);var a=this.getSelector(b,c);return a?this.get$Container().find(a):$()},getConfig:function(a){return a?this._config[a]:this._config},_initBindings:function(){},_init:function(){},_startUp:function(){},_:function(){var a=arguments[0];var b=$.isArray(arguments[1])?arguments[1]:[].slice.call(arguments,1);return r(this._config.translations[a]||"-",b)},getURL:function(){var a=arguments[0];var b=[].slice.call(arguments,1);return r(this._config.urls[a]||"-",b)},getEvent:function(b,a){a=a||"internal";return[this._uuid,a,b].join(".")},on:function(a,c){var b=this;$(document).on(this.getEvent(a,"public"),function(){c.apply(b,arguments)});return this},one:function(a,c){var b=this;$(document).one(this.getEvent(a,"public"),function(){c.apply(b,arguments)});return this},trigger:function(){var a=arguments[0];var b=[].slice.call(arguments,1);$(document).trigger(this.getEvent(a,"public"),b);return this},get:function(a){return this[a]},log:function(a){if(g_dev){console.log(this[a])}return this},_if_dev:function(){return g_dev}});var Translations=Class.$extend({__classvars__:{_translations:{},set:function(a){this._translations=a},add:function(a,b){this._translations[a]=b},has:function(a){return this._translations[a]!==undefined},_:function(){var a=arguments[0],b=[].slice.call(arguments,1),c=r(this._translations[a]||"-",b);if($.type(c)==="string"){c=c.replace(/\[q,\d+,[^,]+,[^,]+\]/g,function(d){var f=d.slice(1,d.length-1).split(",");var e=parseInt(f[1],10);return[e,e<=1?f[2]:f[3]].join(" ")})}return c}}});var Manager=Class.$extend({__classvars__:{_instances:{},get:function(a){return Manager().$class._instances[a]},save:function(a,b){Manager().$class._instances[a]=b},list:function(){$.each(Manager().$class._instances,function(b,a){console.log(b,a)})}}});var GandiInit=AbstractPageManager.$extend({_initBindings:function(){this._ajaxInit();this._initBubule();this._initModalbox();this._globalBindings();this._globalVars();this._setJsClass();this._setContextMenu()},_initBubule:function(){var a=false;BubuleManager.declare({targetElement:this.get$("genericBubule"),autoselectContent:a});BubuleManager.declare({targetElement:this.get$("rightBubule"),position:"right",autoselectContent:a});BubuleManager.declare({targetElement:this.get$("leftBubule"),position:"left",autoselectContent:a});BubuleManager.declare({targetElement:this.get$("bottomBubule"),position:"bottom",autoselectContent:a});BubuleManager.declare({targetElement:this.get$("tagBubule"),style:"tag",position:"right",autoselectContent:a})},_initModalbox:function(){if(typeof($().dialog)==="function"){$(".modalbox").ajaxModal()}},_ajaxInit:function(){AJAX.autoHideMessages();jQuery.ajaxSetup({cache:false,jsonp:null,jsonpCallback:null});$(document).ajaxError(function(h,g){if(g.status&&$.inArray(g.status,[401,404,500,501])>-1){var j;if(g.status==501){j=g.responseText}else{try{j=[];var c=jQuery.parseJSON(g.responseText)["error"];if(c){j.push(c)}var b=jQuery.parseJSON(g.responseText)["raw_error"];if(b){j.push(r("(%s)",b))}}catch(f){j=Translations.has(g.status)?Translations._(g.status):Translations._("500")}}if($(".ui-dialog").length){var a="modalBoxErrorContainer";if(!$("#"+a).length){var d=$("<div>").attr("id",a).addClass("error");$(".ui-dialog").find("h1").first().after(d)}GANDI.Message.error(j,{containerId:"modalBoxErrorContainer"})}else{GANDI.Message.error(j)}}})},_globalVars:function(){keyCode={ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91}},_globalBindings:function(){this.get$("resetFocusEl").focusClearsDefault()},_setJsClass:function(){this.get$Container().addClass("js")},_setContextMenu:function(){var a=document.createElement("menu");a.setAttribute("type","context");if(a.type=="context"){$("#header").attr("contextmenu","logomenu").append('                    <menu type="context" id="logomenu">                        <menuitem label="'+$("#header").data("contextmenu")+'" icon="/favicon.ico" onclick="window.location = \'/press#logo\'">                        </menuitem>                    </menu>                ')}}});var LoginManager=AbstractPageManager.$extend({_initBindings:function(){this._initRequestURI();this._bindForm()},_initRequestURI:function(){var a=window.location.hash;if(a){var b=this.get$("redirect_uri").val();b=b.replace(/(?:#.*)?$/,a);this.get$("redirect_uri").val(b)}},_bindForm:function(){var a=this;this.get$("form").on("submit",function(b){b.preventDefault();GANDI.Ajax.init(b,{},{defaultCallbacks:false}).on({success:function(c){if(c&&c.redirect){window.location.replace(c.redirect)}if(c&&c.totp){a.get$("totpContainer").fadeIn().find("label").addClass("required").end().find("input").prop("disabled",false).prop("required",true).focus()}}}).on({error:function(c){if(c&&c.status===401){window.location.reload()}}});a.get$("totpContainer").find("input").select()})}});var Legacyv4Manager=AbstractPageManager.$extend({_startUp:function(){this._setSameHeight()},_setSameHeight:function(){var a=this.get$("mainArticle").innerHeight();rightBlocksHeight=this.get$("rightBlocks").innerHeight(),maxHeight=_.max([a,rightBlocksHeight]),heightStr=maxHeight+"px";this.get$("mainArticle").innerHeight(heightStr);this.get$("rightBlocks").innerHeight(heightStr)}});function getElementsByClass(f,b,k){var h=new Array();if(b==null){b=document}if(k==null){k="*"}var d=b.getElementsByTagName(k);var a=d.length;var g=new RegExp("(^|\\s)"+f+"(\\s|$)");for(var e=0,c=0;e<a;e++){if(g.test(d[e].className)){h[c]=d[e];c++}}return h}function submitForm(b){try{document.getElementById(b).action=this.href;document.getElementById(b).submit()}catch(a){return true}return false}$(document).ready(function(){new GandiInit({container:"body",selector:{genericBubule:".tipster:not(.bottom):not(.right):not(.left)",rightBubule:".tipster.right",leftBubule:".tipster.left",bottomBubule:".tipster.bottom",tagBubule:".tipster-tag",resetFocusEl:".reset-focus"}});var b=$("#head-status");if(b.length){var a=b.attr("href")+"/api/status";$.ajax({url:a,cache:true,global:false,dataType:"json"}).done(function(d){if(typeof(d)!=="object"){return}var c={SUNNY:"green",CLOUDY:"orange",STORMY:"red"}[d.status];if(c){b.addClass("servstat-"+c)}})}});